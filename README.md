# Music player
Тестовое задание для [gocloudcamp](https://github.com/gocloudcamp/test-assignment)

## Установка
```
git clone https://github.com/powehihihi/playlist && cd playlist
```
### Docker
Приложение:
```
docker build -f Dockerfile.App -t 'app' .
docker run -ti -e TERM app
```
Тесты без приложения (сборка ~8 минут, сами тесты ~4 минуты):
```
docker build -f Dockerfile.Test  -t 'tests' .
docker run tests
```

## Часть 1
Интерфейс из задания реализован в классе [**Playlist**](src/playlist.hpp).
Все запросы отправляются в очередь запросов. Отдельный поток, эмулирующий проигрывание музыки обрабатывает эти запросы. Таким образом воспроизведение и методы не блокируют друг друга, и все запросы будут выполнены в порядке поступления.

Проигрывание музыки эмулируется ожиданием в одну секунду: 
Поток пытается подождать 1 секунду, если получает запрос, то прерывается на выполнение запроса и затем заново ждёт. 
Если за эту секунду не было запросов, то поток начинает эмулировать следующую секунду/трек.

Интерфейс покрыт [**тестами**](test/test.cpp) с помощью библиотеки Catch2. Тесты рассматривают основную бизнес-логику и неочевидные случаи (например, многократные запросы Pause/Play, запрос Prev на первом треке).

## Часть 2
Не сделал

## Бонус - UI
Пользовательский интерфейс реализован с помощью библиотеки ncurses. В одном потоке - обработка нажатий, в другом - отображение текущего трека и секунды. Последнее достигается с помощью класса [**SharedState**](src/SgaredState.cpp) - класс [**Playlist**](src/playlist.hpp) каждую прошедшую (без полученных сигналов) секунду вызывает метод SharedState::Update, который обновляет текущее состояние и уведомляет UI.



[Screencast from 2023-03-11 11-16-21.webm](https://user-images.githubusercontent.com/110171941/224473995-d896c468-b4f1-411f-8f5c-cf2910e36ce1.webm)
